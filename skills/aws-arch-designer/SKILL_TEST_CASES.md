# AWS 架构设计器 Skill 测试用例

## 测试用例 1: 电商平台云迁移

**输入材料**:
```
会议主题: XX电商平台云迁移讨论
参会人员: 张三(CTO)、李四(架构师)、王五(运维)

关键讨论点:
- 现有系统用 Java Spring Boot, MySQL 数据库
- 日活大概 5-10 万，高峰期会翻倍
- 希望迁到云上，减少运维成本
- 数据不能出境，必须在中国
- 老板要求 99.9% 可用性
- 预算还没定，先出个方案

待确认:
- 是否需要容器化? (李四倾向于先用虚拟机)
- 备份策略怎么做?
```

**期望输出**:
- 项目类型: Web-Application
- 架构模式: Web 三层架构
- 主要服务: ALB + EC2 ASG + RDS Multi-AZ
- 追问: RTO/RPO、峰值 QPS、合规要求
- 文档: 11 章节完整设计说明书

---

## 测试用例 2: AI 知识库问答系统

**输入材料**:
```
项目需求: 企业知识库问答系统

功能要求:
- 用户可以上传公司文档（PDF、Word、Excel）
- 支持员工提问，系统根据文档内容回答
- 需要支持中文
- 需要记录查询历史

规模预估:
- 预计 1000 个文档
- 每天 500 次查询
- 100 个并发用户

业务目标:
- 提升员工查询效率
- 减少重复性咨询
```

**期望输出**:
- 项目类型: AI/ML-RAG
- 架构模式: RAG 架构
- 主要服务:
  - LLM: Bedrock (Claude 3.5 Haiku)
  - 向量数据库: OpenSearch Serverless
  - Embedding: Titan Embeddings v2
  - 存储: S3
  - 会话: DynamoDB
- AI 特有检查: Token 成本、Prompt Injection、幻觉检测
- 追问: 响应延迟要求、成本预算
- 文档: 包含 AI 项目特殊章节

---

## 测试用例 3: 实时数据分析平台

**输入材料**:
```
项目背景: IoT 设备数据实时分析

需求:
- 1000 个 IoT 设备持续上报数据
- 每秒 10000 条数据
- 需要实时分析和告警
- 数据需要存储 30 天供查询
- 需要生成每日报表

技术要求:
- 延迟要求: 秒级
- 可用性: 99.9%
- 数据不能丢失
```

**期望输出**:
- 项目类型: BigData-Streaming
- 架构模式: 实时数据处理平台
- 主要服务:
  - 流: Kinesis Data Streams
  - 处理: Lambda / Kinesis Data Analytics
  - 存储: DynamoDB (热数据) + S3 (冷数据)
  - 分析: Athena
- 大数据特有检查: Shard 容量规划、数据一致性、成本优化
- 追问: RTO/RPO、数据保留策略
- 文档: 包含大数据项目特殊章节

---

## 测试用例 4: AI Agent 任务编排系统

**输入材料**:
```
项目: 智能客服 Agent 系统

功能:
- 用户提问后，Agent 自动判断需要调用哪些工具
- 工具包括: 查询订单、查询物流、查询库存、退款申请
- Agent 需要多轮对话理解用户意图
- 需要对接现有的订单系统 API

业务目标:
- 自动化处理 80% 的客服咨询
- 减少人工客服压力
- 预计每天 1000 次会话
```

**期望输出**:
- 项目类型: AI/ML-Agentic
- 架构模式: AI Agentic 系统
- 主要服务:
  - Agent: Bedrock Agents
  - Tools: Lambda Functions (Action Groups)
  - Workflow: Step Functions
  - State: DynamoDB
  - Event: EventBridge
- AI 特有检查: Tool 设计、状态管理、错误处理、降级策略
- 追问: API 调用频率、超时要求
- 文档: 包含 Agent 工具设计章节

---

## 测试用例 5: 数据湖架构

**输入材料**:
```
项目: 企业数据湖建设

数据源:
- 业务数据库（MySQL、PostgreSQL）
- 应用日志（每天 500 GB）
- 第三方数据（API 同步）

需求:
- 统一存储所有数据
- 支持数据分析师即席查询
- 支持数据科学团队做 ML 训练
- 需要数据治理和权限控制
- 数据保留 3 年

规模:
- 初期 50 TB
- 年增长 100%
```

**期望输出**:
- 项目类型: BigData-DataLake
- 架构模式: 数据湖架构
- 主要服务:
  - 存储: S3 (Raw/Curated/Analytics Zones)
  - 治理: Lake Formation
  - 目录: Glue Catalog
  - 查询: Athena / Redshift Spectrum
  - ETL: Glue
- 大数据特有检查: 数据分区策略、存储格式、生命周期策略、访问控制
- 追问: 查询频率、合规要求、成本预算
- 文档: 包含数据治理章节

---

## 测试流程

### 步骤 1: 准备测试
1. 安装 `aws-arch-designer.skill` 到 DeepV Code CLI
2. 确认 Skill 已加载

### 步骤 2: 执行测试
对于每个测试用例:
1. 将"输入材料"作为用户消息发送
2. 观察 Skill 是否自动触发
3. 检查 Skill 是否执行 4 步流程
4. 回答 Skill 的追问问题
5. 验证最终输出

### 步骤 3: 验证输出
检查生成的设计文档是否包含:
- ✅ 11 个章节全部存在
- ✅ 每个技术选择有 Why 和 Trade-off
- ✅ 项目类型识别正确
- ✅ 架构模式选择合理
- ✅ WAF 检查完整
- ✅ 追问问题合理
- ✅ 假设和待确认事项明确标注
- ✅ 文风专业，适合交付

### 步骤 4: 记录结果
记录每个测试用例的:
- 通过/失败状态
- 发现的问题
- 改进建议

---

## 预期测试结果

所有 5 个测试用例应该:
- ✅ 正确识别项目类型
- ✅ 选择正确的架构模式
- ✅ 生成合理的服务选型
- ✅ 执行完整的 WAF 检查
- ✅ 提出必要的追问
- ✅ 生成完整的 11 章节文档

---

## 补充测试场景

### 边界情况测试

**测试 6: 信息极度缺失**
```
用户说: "我想做一个系统，帮我设计一下"
```
期望: Skill 应该提出大量追问，引导用户提供足够信息

**测试 7: China Region 特判**
```
需求: 在中国区部署 AI 系统
- 使用 Amazon Bedrock
- 数据不出境
```
期望: 检查 Bedrock 在 China Region 的可用性，给出替代方案

**测试 8: 成本敏感项目**
```
需求: 低成本 Web 应用
- 预算: 每月 $100
- 流量: 每天 1000 用户
```
期望: 推荐 Serverless 架构（Lambda + DynamoDB），强调成本优化

**测试 9: 高可用要求**
```
需求: 金融交易系统
- 可用性: 99.99%
- RTO < 5 分钟
- RPO = 0（不能丢数据）
```
期望: 推荐 Multi-Region 部署，Aurora Global Database，详细的灾备方案

**测试 10: 混合架构**
```
需求: 既有 Web 应用，又有 AI 功能
- 电商平台 + AI 推荐系统
```
期望: 识别为混合项目，组合多个架构模式

---

## 性能测试

测试 Skill 在以下场景的表现:
- 处理长篇会议记录（5000+ 字）
- 处理复杂需求（多个子系统）
- 处理模糊需求（需要多轮追问）
- 处理技术术语混杂的输入

---

## 回归测试

每次 Skill 更新后，重新运行所有测试用例，确保:
- 现有功能不被破坏
- 新功能正常工作
- 输出质量没有下降
