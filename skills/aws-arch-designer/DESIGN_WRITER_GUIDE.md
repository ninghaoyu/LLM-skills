# Design Writer 详细实施指南

> 本文档是 [SKILL.md](./SKILL.md) 步骤 4 的详细指南。请先阅读 SKILL.md 了解整体流程，再参考本文档获取 Design Writer 的完整细节。

## 概览

Design Writer（设计文档生成）是 AWS 架构设计说明书生成器的第 4 个步骤，负责根据架构决策生成标准化的 Markdown 设计文档。

**关键点**:
- ✅ 根据项目类型选择对应的标准化模板
- ✅ 填充所有占位符
- ✅ 生成完整的 Markdown 文件
- ✅ 输出经过验证的设计说明书

---

## 4.0 模板选择（CRITICAL）

根据步骤 1 识别的项目类型，选择对应的标准化模板。

### 项目类型与模板映射

| 项目类型 | 模板文件 | 特殊章节 | 适用场景 |
|---------|---------|---------|---------|
| **AI/ML-Agentic** | `design_doc_template_ai_agentic.md` | Agent 编排、工具链、负责任 AI、幻觉检测 | Bedrock Agents、LangGraph |
| **其他所有类型** | `design_doc_template.md` | 标准 11 章 | Web、RAG、GenAI、大数据、迁移等 |

**不要混用模板**:
- ❌ 不要在 AI Agentic 项目中使用通用模板
- ❌ 不要在其他项目中使用 AI Agentic 专用模板
- ✅ 根据项目类型严格选择对应模板

### AI Agentic 专用模板特色

- ✨ 14 个章节（比通用模板多 3 个）
- ✨ 专门的推理与 LLM 部署、Agent 编排、状态管理、向量存储章节
- ✨ 强化的安全性和负责任 AI 设计
- ✨ Agent 特定的成本和性能优化
- ✨ Agentic AI 能力评估矩阵和实施路线图

---

## 4.1 关键占位符速查表

### 必填占位符（P0 - Critical）

| 占位符 | 数据源 | 说明 |
|-------|--------|------|
| `{PROJECT_NAME}` | 步骤 1 | 项目名称 |
| `{BUSINESS_GOALS}` | 步骤 1 | 业务目标列表 |
| `{ARCHITECTURE_STYLE}` | 步骤 3 | 架构模式 |
| `{CORE_COMPONENTS}` | 步骤 3 | 核心 AWS 服务 |
| `{ARCHITECTURE_DIAGRAM_DESCRIPTION}` | 步骤 2 | 架构图文字描述 |
| `{IAM_DESIGN}` | 步骤 3 | IAM 角色和权限 |
| `{BACKUP_STRATEGY}` | 步骤 3 | 备份和灾备方案 |
| `{RTO}` / `{RPO}` | 步骤 1 | 恢复目标 |
| `{ASSUMPTIONS}` | 步骤 1 | 假设清单 |
| `{OPEN_QUESTIONS}` | 步骤 1 | 待确认问题 |

**AI Agentic 额外必填占位符**:
- `{LLM_MODEL_CHOICE}` - 选择的模型
- `{TOKEN_COST_CONTROL_STRATEGY}` - Token 成本控制
- `{AGENT_ORCHESTRATOR_CHOICE}` - Agent 编排器选择
- `{HALLUCINATION_DETECTION}` - 幻觉检测方案

详细完整列表请参考原始 SKILL.md 或本文档的完整版本。

---

## 4.2 章节结构

### 通用模板（11 章）
1. 设计背景与目标
2. 架构设计原则
3. 总体架构概述
4. 网络架构设计
5. 计算层设计
6. 存储与数据库设计
7. 安全与权限设计
8. 高可用与灾备设计
9. 运维与监控设计
10. 成本与扩展性分析
11. 风险、假设与待确认事项

### AI Agentic 专用模板（14 章）
1. 设计背景与目标
2. **AI Agentic 架构设计原则** (NEW)
3. **总体架构概述** (强化 Agent/LLM 说明)
4. 网络架构设计
5. **推理与 LLM 部署设计** (NEW - 替代通用第 5 章)
6. **Agent 编排与工具设计** (NEW)
7. **状态管理与记忆设计** (NEW)
8. **向量存储与知识库设计** (NEW - 若用 RAG)
9. 计算层设计
10. **安全与负责任 AI 设计** (强化)
11. 高可用与灾备设计
12. **运维、监控与可观测性设计** (强化)
13. **成本与性能优化** (强化)
14. 风险、假设与待确认事项
- 附录 A: Agentic AI 能力评估矩阵
- 附录 B: 项目实施路线图

---

## 4.3 每章必须包含

✅ **设计选择的具体内容** - 清晰说明选了什么
✅ **选择理由（Why）** - 为什么这样选择
✅ **权衡说明（Trade-off）** - 优势和劣势
✅ **假设标注** - 标注 `【假设】` 或 `【待确认】`

---

## 4.4 验证清单

**通用模板项目**:
- [ ] 11 个章节完整
- [ ] 没有 `{PLACEHOLDER}` 残留
- [ ] 每个决策都有 Why 和 Trade-off
- [ ] 假设已标注
- [ ] 使用 `design_doc_template.md`

**AI Agentic 项目**:
- [ ] 14 个章节完整（包括新增的 3 章）
- [ ] Token 成本控制策略明确
- [ ] Agent 工具集成方案完整
- [ ] 幻觉检测和 HITL 方案明确
- [ ] 附录 A (能力评估) 完整
- [ ] 附录 B (实施路线图) 完整
- [ ] 使用 `design_doc_template_ai_agentic.md`

---

## 4.5 文件命名和输出

**文件命名规则**:
```
{PROJECT_NAME}_架构设计说明书_v1.0.md

示例:
- 电商平台迁移_架构设计说明书_v1.0.md
- AI客服代理_Agentic_架构设计说明书_v1.0.md
- 企业知识库_RAG_架构设计说明书_v1.0.md
```

**输出要求**:
- 生成完整的 Markdown 文件
- 保存或返回给用户
- 所有占位符已填充
- 格式规范正确

---

## 4.6 Prompt 模板

### AI Agentic 项目 Prompt

```
你是 AWS 解决方案架构师。基于已完成的架构决策，
生成《AWS AI Agentic 架构设计说明书》。

【输入】
- 步骤 1: 需求数据
- 步骤 2: 架构图
- 步骤 3: 架构决策和 WAF 评估

【任务】
1. 使用 design_doc_template_ai_agentic.md
2. 填充 14 个章节（包含新增的 3 章）
3. 强化 Token 成本控制、Agent 编排、幻觉检测
4. 生成附录 A (能力评估) 和附录 B (实施路线图)
5. 输出完整 Markdown 文件

【关键】
- ✅ 遵循 14 章结构
- ✅ Token 成本明确
- ✅ 幻觉检测和 HITL 方案清晰
- ❌ 不要使用通用模板
- ❌ 不要跳过新增的 3 章
```

### 其他项目类型 Prompt

```
你是 AWS 解决方案架构师。基于已完成的架构决策，
生成《AWS 架构设计说明书》。

【输入】
- 步骤 1: 需求数据
- 步骤 2: 架构图
- 步骤 3: 架构决策和 WAF 评估

【任务】
1. 使用 design_doc_template.md
2. 填充所有占位符
3. 按 11 个章节顺序
4. 输出完整 Markdown 文件

【关键】
- ✅ 遵循 11 章结构
- ✅ 每个决策都有 Why 和 Trade-off
- ✅ 假设已标注
- ❌ 不要改变章节顺序
- ❌ 不要引入未确认的需求
```

---

## 总结

成功的关键：
1. **选择正确模板** - AI Agentic 用专用模板
2. **完整填充占位符** - 无遗漏、无残留
3. **遵循章节结构** - 按顺序，不合并
4. **突出 Why 和 Trade-off** - 每个决策都要解释
5. **验证和测试** - 使用验证清单

---

详细的占位符完整列表、格式示例、及其他细节，请查阅原始 SKILL.md 或备份 SKILL.md.backup 文件。
